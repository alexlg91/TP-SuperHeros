<!DOCTYPE html>
<html lang="fr">
    <head>

        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>TP VUE.JS HOME</title>
        <script src="https://unpkg.com/vue@3.0.0"></script>
        <script src="https://unpkg.com/axios@latest"></script>
        
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>

    </head>


    <body>
        <div id="app" class="container my-4" v-if="ishome">

            <!-- Barre de navigation -->
            <div id="navbarplaceholder"></div>
        
            <h1>Liste des Superheros</h1> <br>
            <input type="text" class="form-control mb-3" v-model="searchtexte" placeholder="Rechercher un superhéros"><button @click="cherche()">Chercher</button>
            <button @click="reset()">Réinitialiser</button>
            
            <input type="checkbox" name="Afficher les pouvoirs" v-model="ispower"> Afficher les Pouvoirs
            <br><br>
            <ul class="list-group" v-if="!issearch" >
                <a v-for="hero in superheros" class="list-group-item list-group-item-action d-flex justify-content-between align-items-center nav-item nav-link" :href="'details.html?id=' + hero.id">
                        <h5 class="mb-0">{{ hero.name }}</h5>
                        <img :src="hero.images.md" class="rounded-circle" width="50" alt="Image" style="align-items: center ;">
                        <small v-if="ispower">STATS: Intellignce: {{ hero.powerstats.intelligence }} Force: {{ hero.powerstats.strength }} Vitesse: {{ hero.powerstats.speed }} Durabilité: {{ hero.powerstats.durability }} Pouvoirs: {{ hero.powerstats.power }} Combat: {{ hero.powerstats.combat }}</small>
                        <small>ID: {{ hero.id }}</small>
                </a>
            </ul>

            <!--Affichage de la recherche-->

            <ul class="list-group" v-if="issearch">
                <li v-for="hero in filteredSuperheros" class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">
                    <h5 class="mb-0">{{ hero.name }}</h5>
                    <img :src="hero.images.md" class="rounded-circle" width="50" alt="Image">
                    <small v-if="ispower">STATS: Intellignce: {{ hero.powerstats.intelligence }} Force: {{ hero.powerstats.strength }} Vitesse: {{ hero.powerstats.speed }} Durabilité: {{ hero.powerstats.durability }} Pouvoirs: {{ hero.powerstats.power }} Combat: {{ hero.powerstats.combat }}</small>
                    <small>ID: {{ hero.id }}</small>
                </li>
            </ul>
        
        </div>
        
        <script>
            const app = Vue.createApp({
                data: function(){
                    return {
                        superheros: [],
                        ispower: false,
                        searchtexte: "",
                        issearch: false,
                    }
                },
                
                mounted() {
                    axios.get('https://cdn.jsdelivr.net/gh/rtomczak/superhero-api@0.3.0/api/all.json').then(response => {
                        this.superheros = response.data; // Récupérer les données des superhéros
                    }).catch(error => {
                        console.log(error);
                    });

                    fetch('navbar.html')
                        .then(response => response.text())
                        .then(data => {
                        document.getElementById("navbarplaceholder").innerHTML = data;
                        })

                },

                methods:{

                    reset(){
                        this.issearch = !this.issearch
                        return this.searchtexte = "";
                    },

                    cherche(){
                        return this.issearch = !this.issearch;
                    },

                },

                computed: {
                    filteredSuperheros() {
                        return this.superheros.filter(
                            hero => hero.name.toLowerCase().includes(this.searchtexte.toLowerCase())
                        );
                    },                    
                },
                

            });
            app.mount('#app');
        </script>
        
    </body>
</html>
